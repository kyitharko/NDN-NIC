<!doctype html>
<meta charset="utf-8">
<title>visualize fp-classify output</title>
<form id="form"><div>
Paste a line of fp-classify output:
<input type="text" id="t_input">
<input type="submit" value="plot">
</div></form>
<div id="venn"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
<script src="https://benfred.github.io/venn.js/venn.js"></script>
<script>
document.getElementById('form').addEventListener('submit', function(evt){
  evt.preventDefault();

  var input = document.getElementById('t_input').value;

  var tokens = input.split(/\s+/);
  if (tokens.length < 7) {
    alert('need at least 7 columns');
    return;
  }

  var columns = tokens.slice(tokens.length - 7)
                      .map(function(v){ return parseInt(v); });
  columns.unshift(NaN);
  function getValue(bits) {
    var sum = 0;
    for (var i = 1; i <= 7; ++i) {
      if ((i & bits) == bits) {
        sum += columns[i];
      }
    }
    return sum;
  }

  var sets = [ {sets: ['BF'], size: getValue(1)},
               {sets: ['PM'], size: getValue(2)},
               {sets: ['BF', 'PM'], size: getValue(3)},
               {sets: ['PT'], size: getValue(4)},
               {sets: ['BF', 'PT'], size: getValue(5)},
               {sets: ['PM', 'PT'], size: getValue(6)},
               {sets: ['BF', 'PM', 'PT'], size: getValue(7)}
             ].filter(function(set) { return set.size != 0; });
  console.log(sets);

  var chart = venn.VennDiagram();
  d3.select("#venn").datum(sets).call(chart);
});
</script>
